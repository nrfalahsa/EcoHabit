<!DOCTYPE html>
<html lang="id">
<head>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/dashboard.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header class="dashboard-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">EcoHabit</div>
                <div class="user-info">
                    <span>Halo, <span id="userName">Pengguna</span>!</span>
                    <button id="logoutBtn" class="btn btn-secondary btn-sm">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <main class="dashboard-main">
        <div class="container">

            <div id="loadingState">
                <div class="dashboard-grid">
                    <aside class="sidebar">
                        <div class="card skeleton">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-badge"></div>
                        </div>
                        <div class="card skeleton">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-text"></div>
                            <div class="skeleton-text"></div>
                            <div class="skeleton-text"></div>
                        </div>
                        <div class="card skeleton">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-text"></div>
                            <div class="skeleton-text"></div>
                            <div class="skeleton-text"></div>
                        </div>
                        <div class="card skeleton">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-text"></div>
                            <div class="skeleton-text short"></div>
                        </div>
                    </aside>
                    <section class="main-content">
                        <div class="card skeleton">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-text"></div>
                            <div class="skeleton-text"></div>
                            <div class="skeleton-text"></div>
                        </div>
                        <div class="card skeleton">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-chart"></div>
                        </div>
                    </section>
                </div>
            </div>

            <div id="errorState" class="card error-card hidden">
                <h2 class="card-title">Terjadi Kesalahan</h2>
                <p id="errorMessageText">Gagal memuat data dashboard. Silakan coba muat ulang halaman.</p>
                <button onclick="window.location.reload()" class="btn">Muat Ulang</button>
            </div>

            <div id="dashboardContent" class="dashboard-grid hidden">
                
                <aside class="sidebar">
                    <div class="card">
                        <h2 class="card-title">Level & Badge</h2>
                        <div class="level-badge">
                            <div class="badge-icon" id="levelBadge">üå±</div>
                            <div class="badge-info">
                                <h3 id="levelText">üå± Green Starter</h3>
                                <p id="pointsText">0 Total Poin</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2 class="card-title">Total Dampak Kamu</h2>
                        <div class="impact-stats">
                            <div class="impact-item">
                                <span class="impact-icon">üí®</span>
                                <div class="impact-text">
                                    <span class="impact-value" id="totalCo2">0 kg</span>
                                    <span class="impact-label">CO2 Ditekan</span>
                                    <span class="impact-analogy" id="co2Analogy"></span>
                                </div>
                            </div>
                            <div class="impact-item">
                                <span class="impact-icon">üíß</span>
                                <div class="impact-text">
                                    <span class="impact-value" id="totalWater">0 L</span>
                                    <span class="impact-label">Air Dihemat</span>
                                    <span class="impact-analogy" id="waterAnalogy"></span>
                                </div>
                            </div>
                            <div class="impact-item">
                                <span class="impact-icon">‚ôªÔ∏è</span>
                                <div class="impact-text">
                                    <span class="impact-value" id="totalPlastic">0 gr</span>
                                    <span class="impact-label">Plastik Dikurangi</span>
                                    <span class="impact-analogy" id="plasticAnalogy"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h2 class="card-title">üèÜ Lencana Saya</h2>
                        <div class="badge-grid" id="badgeGrid"></div>
                    </div>

                    <div class="card">
                        <h2 class="card-title">üèÜ Papan Peringkat</h2>
                        <div class="leaderboard">
                            <ol id="leaderboardList">
                                </ol>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2 class="card-title">Motivasi AI</h2>
                        <div class="quote-section">
                            <div class="quote-text" id="aiQuoteText">
                                "Memuat..."
                            </div>
                            <div class="quote-author" id="aiQuoteAuthor">
                                - EcoHabit
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h2 class="card-title">Asisten Eco</h2>
                        <div class="ai-assistant">
                            <div class="form-group">
                                <textarea id="aiQuestionInput" class="form-input" rows="3" placeholder="Tanya apa saja tentang lingkungan..."></textarea>
                            </div>
                            <div class="ai-buttons">
                                <button id="aiAskBtn" class="btn btn-sm">Tanya AI</button>
                                <button id="aiSuggestBtn" class="btn btn-secondary btn-sm">Beri Saran Aktivitas</button>
                            </div>
                            <div id="aiResponseArea" class="ai-response"></div>
                        </div>
                    </div>
                </aside>

                <section class="main-content">
                    <div class="card">
                        <h2 class="card-title">Aktivitas Hijau Hari Ini</h2>
                        <div class="filter-container">
                            <button class="btn-filter active" data-filter="Semua">Semua</button>
                            <button class="btn-filter" data-filter="Rumah">Rumah</button>
                            <button class="btn-filter" data-filter="Konsumsi">Konsumsi</button>
                            <button class="btn-filter" data-filter="Transportasi">Transportasi</button>
                            <button class="btn-filter" data-filter="Lainnya">Lainnya</button>
                        </div>
                        <div id="activitiesList"></div>
                    </div>

                    <div class="card">
                        <h2 class="card-title">Statistik Poin Mingguan</h2>
                        <div class="chart-container">
                            <canvas id="progressChart"></canvas>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <div id="logoutModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Konfirmasi Logout</h3>
                <button id="closeModalBtn" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Apakah Anda yakin ingin keluar dari akun Anda?</p>
            </div>
            <div class="modal-footer">
                <button id="cancelLogoutBtn" class="btn btn-secondary">Batal</button>
                <button id="confirmLogoutBtn" class="btn btn-danger">Yakin, Logout</button>
            </div>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html>